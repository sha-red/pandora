[Unit]
Description=pandora tasks daemon
After=postgresql.service rabbitmq-server.service

[Service]
Type=simple
Restart=always
User=pandora
Group=pandora
PIDFile=/run/pandora/tasks.pid
WorkingDirectory=/srv/pandora/pandora
ExecStart=/srv/pandora/bin/celery \
    -A app worker \
    -Q default,celery -n pandora-default \
    --pidfile /run/pandora/tasks.pid \
    --maxtasksperchild 1000 \
    -l INFO
ExecReload=/bin/kill -TERM $MAINPID

[Install]
WantedBy=multi-user.target
